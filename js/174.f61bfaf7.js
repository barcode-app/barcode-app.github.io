"use strict";(globalThis["webpackChunkbarcode_store"]=globalThis["webpackChunkbarcode_store"]||[]).push([[174],{2620:(e,t,s)=>{s.d(t,{O3:()=>l,OB:()=>i,Px:()=>o,de:()=>a});class a{constructor(e){this._settings={locale:"en-US",isAdmin:!1,globalDebug:!1,homePageDebug:!1,barCodePageDebug:!1,settingsPageDebug:!1},this.DB_KEY="SETTINGS",this._local=e.localStorage,null===this._local.getItem(this.DB_KEY)&&this._local.set(this.DB_KEY,JSON.stringify(this.getState()));const t=JSON.parse(this._local.getItem(this.DB_KEY)+"");this._settings=Object.assign(Object.assign({},this._settings),t)}saveData(){this._local.set(this.DB_KEY,JSON.stringify(this.getState()))}getState(){return this._settings}get locale(){return this._settings.locale}set locale(e){this._settings.locale=e}get isAdmin(){return this._settings.isAdmin}set isAdmin(e){this._settings.isAdmin=e}get globalDebug(){return this._settings.globalDebug}set globalDebug(e){this._settings.globalDebug=e}get barCodePageDebug(){return this._settings.barCodePageDebug}set barCodePageDebug(e){this._settings.barCodePageDebug=e}get homePageDebug(){return this._settings.homePageDebug}set homePageDebug(e){this._settings.homePageDebug=e}get settingsPageDebug(){return this._settings.settingsPageDebug}set settingsPageDebug(e){this._settings.settingsPageDebug=e}}class l{constructor(e,t=!1){this._saveState="",this._stateEngine=new e(t),this._debug=t}setState(e){this._dataObject=e}get stateString(){return JSON.stringify(this._dataObject)}beginEdit(){this._saveState=this.stateString,this._stateEngine.errors=[],this._debug&&console.log("StateManager beginEdit",this._saveState)}isDirty(){return this._debug&&console.log("StateManager isDirty",this._saveState!==this.stateString,this.stateString),this._saveState!==this.stateString}validate(){return this._debug&&console.log("StateManager validate"),this._stateEngine.validate(this._dataObject)}copyState(e){this._debug&&console.log("StateManager copyState"),this._stateEngine.copyState(e,this._dataObject)}restoreState(e){this._debug&&console.log("StateManager restoreState"),this._stateEngine.restoreState(e,JSON.parse(this._saveState))}get errors(){return this._stateEngine.errors}}class i{constructor(e){this._debug=e,this._errors=[]}get errors(){return this._errors}set errors(e){this._errors=e}validate(e){this._debug&&console.log("validate");let t=!0;return this._errors=[],""===e.caption&&(t=!1,this._errors.push("barcode-error-caption")),""===e.barCode&&(t=!1,this._errors.push("barcode-error-barcode")),t}copyState(e,t){this._debug&&console.log("copyState",e),t.caption=t.caption,t.barCode=t.barCode,t.expanded=t.expanded,t.tags=t.tags,t.notes=t.notes}restoreState(e,t){this._debug&&console.log("restoreState",e),e.caption=t.caption,e.barCode=t.barCode,e.expanded=t.expanded,e.tags=t.tags,e.notes=t.notes}}class o{constructor(e){this.KEY_BARCODE_DB="barcode-db",this._state={title:"",itemCaption:"",barcodeCaption:"",barCodes:[]},this._local=e.localStorage,null===this._local.getItem(this.KEY_BARCODE_DB)&&this._local.set(this.KEY_BARCODE_DB,JSON.stringify(this.getState()));const t=JSON.parse(this._local.getItem(this.KEY_BARCODE_DB)+"");this._state=Object.assign(Object.assign({},this._state),t)}getState(){return this._state}get stateString(){return JSON.stringify(this.getState())}restoreData(e){const t=JSON.parse(e);this._state=t}resetData(){this._state.title="",this._state.itemCaption="",this._state.barcodeCaption="",this._state.barCodes=[]}saveData(){this._local.set(this.KEY_BARCODE_DB,this.stateString)}get newItem(){return{caption:"",barCode:"",expanded:!1,tags:[],notes:""}}addBarCode(e){this._state.barCodes.push(e)}deleteBarCode(e){this._state.barCodes=[...this._state.barCodes.slice(0,e),...this._state.barCodes.slice(e+1)]}get barCodes(){return this._state.barCodes}get title(){return this._state.title}set title(e){this._state.title=e}get itemCaption(){return this._state.itemCaption}set itemCaption(e){this._state.itemCaption=e}get barcodeCaption(){return this._state.barcodeCaption}set barcodeCaption(e){this._state.barcodeCaption=e}}},3174:(e,t,s)=>{s.r(t),s.d(t,{default:()=>$});var a=s(9835),l=s(499),i=s(6970),o=s(2620),n=s(9302),r=s(6647),g=s(6646),c=function(e,t,s,a){function l(e){return e instanceof s?e:new s((function(t){t(e)}))}return new(s||(s=Promise))((function(s,i){function o(e){try{r(a.next(e))}catch(t){i(t)}}function n(e){try{r(a["throw"](e))}catch(t){i(t)}}function r(e){e.done?s(e.value):l(e.value).then(o,n)}r((a=a.apply(e,t||[])).next())}))};const u={class:""},d={class:""},b={class:""},h={class:"q-pa-md"},_={class:""},p={class:"q-pa-md"},m={key:0,class:""},v={class:"row q-pb-lg"},S={key:0,class:"q-pb-lg"},D={class:"col text-center q-pb-sm"},C={class:"row q-pb-xl"},k={key:1},f={key:2},y=(0,a.aZ)({__name:"AppSettings",setup(e){const t=(0,n.Z)(),{t:s}=(0,r.QT)(),{locale:y}=(0,r.QT)({useScope:"global"}),V=[{value:"en-US",label:"English"},{value:"zh-SG",label:"中文（新加坡）"}],O=(0,l.iH)(new o.de(t)),w=(0,l.iH)(new o.Px(t)),E=(0,l.iH)("");let P=(0,l.iH)(!1),q=(0,l.iH)(!1);y.value=O.value.locale;const B=(0,a.Fl)((()=>O.value.globalDebug||O.value.settingsPageDebug));function U(){B.value&&console.log("saveHandler"),O.value.locale=y.value,O.value.saveData(),w.value.saveData()}function W(){B.value&&console.log("backupHandler");const e=(0,g.Z)("barCodes-backup.json",w.value.stateString);!0===e?t.notify({message:s("settings-backup-success-message"),type:"positive",position:"center"}):t.notify({message:s("settings-backup-failed-message"),type:"negative",position:"center"})}function $(){B.value&&console.log("restoreHandler"),E.value.startsWith("{")?t.dialog({title:s("confirm"),message:s("settings-restore-confirm-message"),cancel:!0,persistent:!0}).onOk((()=>c(this,void 0,void 0,(function*(){w.value.restoreData(E.value),t.notify({message:s("settings-restore-success-message"),type:"positive",position:"center"}),P.value=!1,E.value=""})))):""===E.value?t.notify({message:s("settings-restore-failed-no-data"),type:"warning",position:"center"}):t.notify({message:s("settings-restore-failed-message"),type:"negative",position:"center"})}function A(){B.value&&console.log("resetHandler"),t.dialog({title:s("confirm"),message:s("settings-reset-confirm-message"),ok:{label:s("settings-yes")},cancel:{label:s("settings-cancel")},focus:"cancel",persistent:!0}).onOk((()=>c(this,void 0,void 0,(function*(){w.value.resetData(),t.notify({message:s("settings-reset-success-message"),type:"positive",position:"center"})}))))}return(0,a.Jd)((()=>{U()})),(e,t)=>{const s=(0,a.up)("q-toggle"),o=(0,a.up)("q-select"),n=(0,a.up)("q-input"),r=(0,a.up)("q-space"),g=(0,a.up)("q-btn"),c=(0,a.up)("q-page");return(0,a.wg)(),(0,a.j4)(c,{class:"col q-pa-md"},{default:(0,a.w5)((()=>[(0,a._)("div",u,[(0,a.Wm)(s,{modelValue:O.value.isAdmin,"onUpdate:modelValue":t[0]||(t[0]=e=>O.value.isAdmin=e),"checked-icon":"check",color:"red",label:e.$t("settings-system_admin"),"unchecked-icon":"clear"},null,8,["modelValue","label"])]),(0,a._)("div",d,[(0,a.Wm)(s,{modelValue:O.value.globalDebug,"onUpdate:modelValue":t[1]||(t[1]=e=>O.value.globalDebug=e),"checked-icon":"check",color:"red",label:e.$t("settings-global-debug-flag"),"unchecked-icon":"clear"},null,8,["modelValue","label"])]),(0,a._)("div",b,[(0,a.Wm)(s,{modelValue:O.value.settingsPageDebug,"onUpdate:modelValue":t[2]||(t[2]=e=>O.value.settingsPageDebug=e),"checked-icon":"check",color:"red",label:e.$t("settings-settings-debug-flag"),"unchecked-icon":"clear"},null,8,["modelValue","label"])]),(0,a._)("div",h,[(0,a.Wm)(o,{modelValue:(0,l.SU)(y),"onUpdate:modelValue":t[3]||(t[3]=e=>(0,l.dq)(y)?y.value=e:null),options:V,label:e.$t("language"),dense:"",borderless:"","emit-value":"","map-options":"","options-dense":"",style:{"min-width":"150px"}},null,8,["modelValue","label"])]),(0,a._)("div",_,[(0,a._)("div",null,[(0,a.Wm)(s,{modelValue:O.value.barCodePageDebug,"onUpdate:modelValue":t[4]||(t[4]=e=>O.value.barCodePageDebug=e),"checked-icon":"check",color:"red",label:e.$t("settings-barcode-debug-flag"),"unchecked-icon":"clear"},null,8,["modelValue","label"])]),(0,a._)("div",p,[(0,a._)("div",null,(0,i.zw)(e.$t("settings-barcode-section-title")),1),(0,a._)("div",null,[(0,a.Wm)(n,{modelValue:w.value.title,"onUpdate:modelValue":t[5]||(t[5]=e=>w.value.title=e),label:e.$t("settings-barcode-pageTitle")},null,8,["modelValue","label"])]),(0,a._)("div",null,[(0,a.Wm)(n,{modelValue:w.value.itemCaption,"onUpdate:modelValue":t[6]||(t[6]=e=>w.value.itemCaption=e),label:e.$t("settings-barcode-item-caption")},null,8,["modelValue","label"])]),(0,a._)("div",null,[(0,a.Wm)(n,{modelValue:w.value.barcodeCaption,"onUpdate:modelValue":t[7]||(t[7]=e=>w.value.barcodeCaption=e),label:e.$t("settings-barcode-barcode-caption")},null,8,["modelValue","label"])])])]),O.value.isAdmin?((0,a.wg)(),(0,a.iD)("div",m,[(0,a._)("div",v,[(0,a.Wm)(s,{modelValue:(0,l.SU)(P),"onUpdate:modelValue":t[8]||(t[8]=e=>(0,l.dq)(P)?P.value=e:P=e),"checked-icon":"check",color:"red",label:e.$t("settings-restore-data"),"unchecked-icon":"clear"},null,8,["modelValue","label"]),(0,a.Wm)(r),(0,a.Wm)(g,{icon:"cloud_download",color:"green",label:e.$t("settings-backup"),onClick:W},null,8,["label"])]),(0,l.SU)(P)?((0,a.wg)(),(0,a.iD)("div",S,[(0,a._)("div",D,[(0,a.Wm)(g,{icon:"cloud_upload",color:"green",label:e.$t("settings-restore"),onClick:$},null,8,["label"])]),(0,a.Wm)(n,{modelValue:E.value,"onUpdate:modelValue":t[9]||(t[9]=e=>E.value=e),filled:"",autogrow:"",label:e.$t("settings-restore-message")},null,8,["modelValue","label"])])):(0,a.kq)("",!0),(0,a._)("div",C,[(0,a.Wm)(s,{modelValue:(0,l.SU)(q),"onUpdate:modelValue":t[10]||(t[10]=e=>(0,l.dq)(q)?q.value=e:q=e),"checked-icon":"check",color:"red",label:e.$t("settings-reset-data"),"unchecked-icon":"clear"},null,8,["modelValue","label"]),(0,a.Wm)(r),(0,l.SU)(q)?((0,a.wg)(),(0,a.j4)(g,{key:0,icon:"restart_alt",color:"red",label:e.$t("settings-reset"),onClick:A},null,8,["label"])):(0,a.kq)("",!0)])])):(0,a.kq)("",!0),B.value?((0,a.wg)(),(0,a.iD)("div",k,[(0,a._)("pre",null,(0,i.zw)(JSON.stringify(O.value,null,4)),1),(0,a._)("pre",null,(0,i.zw)(JSON.stringify((0,l.SU)(y),null,4)),1)])):(0,a.kq)("",!0),O.value.barCodePageDebug?((0,a.wg)(),(0,a.iD)("div",f,[(0,a._)("pre",null,(0,i.zw)(JSON.stringify(w.value,null,4)),1)])):(0,a.kq)("",!0)])),_:1})}}});var V=s(9885),O=s(3175),w=s(215),E=s(6611),P=s(136),q=s(4455),B=s(9984),U=s.n(B);const W=y,$=W;U()(y,"components",{QPage:V.Z,QToggle:O.Z,QSelect:w.Z,QInput:E.Z,QSpace:P.Z,QBtn:q.Z})}}]);